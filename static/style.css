:root{
  --board-blue:#CFEFE9;
  --tile-bg:#FFFFFF;
  --edge-gap:3px;

  /* will be set by JS; default to tiny so nothing overflows before JS runs */
  --stage-size: 320px;
  --ui-scale: 0.3334;
}

*{box-sizing:border-box}
html,body{height:100%}
html{overflow:hidden}
body{
  margin:0;
  font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  background:#0e1217;
  color:#e6edf3;

  display:flex;
  flex-direction:column;
  min-height:100dvh;
  overflow:hidden;
}

/* zero vertical margins to avoid accidental overflow */
header{
  width:100%;
  margin:0 auto;
  padding:6px 12px;
  max-width:min(1200px, 98vw);
  display:flex;flex-wrap:wrap;align-items:center;gap:12px
}
header h1{margin:0;font-weight:900;letter-spacing:.5px}
.hud{display:flex;gap:12px;margin-left:auto}
.metric{background:#141a22;border:1px solid #232a35;border-radius:10px;padding:8px 10px}
.metric span{display:block;color:#99a3af;font-size:12px}
.metric strong{font-size:16px}
.controls{display:flex;gap:8px}
.controls button{
  background:#1f6feb;border:1px solid #2f81f7;color:#fff;border-radius:8px;
  padding:8px 12px;font-weight:700;cursor:pointer
}
.controls button.disabled{opacity:.6;cursor:not-allowed}
.controls button#btn-new{background:#30363d;border-color:#6e7681}

/* no scrolling in main */
main{
  flex:1 1 auto;
  min-height:0;
  max-width:min(1200px, 98vw);
  margin:0 auto;
  padding:6px 12px 6px;
  display:grid;
  place-items:center;
  overflow:hidden;
}

#board-wrap{
  position:relative;
  width:100%;
  height:100%;
  display:grid;
  place-items:center;
  overflow:visible;
}

.stage{
  position:relative;
  width:var(--stage-size);
  height:var(--stage-size);
  transform:rotate(0deg);
  transform-origin:center center;
  will-change: transform;
}

.board{
  position:absolute; inset:0;
  display:grid;grid-template-columns:repeat(11,1fr);grid-template-rows:repeat(11,1fr);
  gap:calc(var(--edge-gap) * var(--ui-scale));
  padding:calc(6px * var(--ui-scale));
  background:var(--board-blue);
  border-radius:calc(18px * var(--ui-scale));
  border:calc(10px * var(--ui-scale)) solid #000;
  box-shadow:0 calc(16px * var(--ui-scale)) calc(40px * var(--ui-scale)) rgba(0,0,0,.45), inset 0 0 0 1px rgba(0,0,0,.06);
}

.cell{position:relative;border-radius:calc(12px * var(--ui-scale));overflow:hidden}
.tile-inner{
  position:absolute;inset:0;background:var(--tile-bg);border-radius:calc(12px * var(--ui-scale));
  box-shadow:0 calc(2px * var(--ui-scale)) calc(5px * var(--ui-scale)) rgba(0,0,0,.16), inset 0 0 0 1px rgba(0,0,0,.08);
  display:grid;grid-template-rows:var(--stripe-h,0px) auto 1fr;
}
.stripe{height:calc(18px * var(--ui-scale));background:var(--stripe,#000);border-bottom:1px solid rgba(0,0,0,.1)}
.stripe.ghost{background:transparent;border-bottom:0;--stripe-h:calc(18px * var(--ui-scale))}
.title{
  padding:calc(6px * var(--ui-scale)) calc(6px * var(--ui-scale)) 0 calc(6px * var(--ui-scale));
  text-align:center;text-transform:uppercase;
  font:800 calc(12px * var(--ui-scale))/1.1 "Franklin Gothic Medium","Arial Narrow",Arial,Helvetica,sans-serif;
  color:#121212;letter-spacing:.4px
}
.emoji-wrap{display:grid;place-items:center;padding:calc(2px * var(--ui-scale)) calc(8px * var(--ui-scale)) calc(8px * var(--ui-scale)) calc(8px * var(--ui-scale))}
.emoji{font-size:calc(24px * var(--ui-scale));line-height:1}

.rot-0{transform:rotate(0deg)}
.rot-90{transform:rotate(90deg)}
.rot-180{transform:rotate(180deg)}
.rot-270{transform:rotate(270deg)}

.center-logo{
  position:absolute;left:50%;top:50%;transform:translate(-50%,-50%) rotate(-45deg);
  width:86%;height:86%;pointer-events:none;opacity:.95;z-index:1
}
.center-logo img{width:100%;height:100%;object-fit:contain;display:block}

.pawn{
  position:absolute;
  width:calc(24px * var(--ui-scale));
  height:calc(24px * var(--ui-scale));
  border-radius:50%;
  background:radial-gradient(circle at 30% 30%, #fff, #d6dbe2);
  border:calc(3px * var(--ui-scale)) solid #050608;
  box-shadow:0 calc(8px * var(--ui-scale)) calc(22px * var(--ui-scale)) rgba(0,0,0,.55), inset 0 0 calc(4px * var(--ui-scale)) rgba(0,0,0,.4);
  transform:translate(-9999px,-9999px);
  transition:transform 260ms ease;
  z-index:30
}

.qbadge{
  position:absolute;
  left:calc(6px * var(--ui-scale));
  bottom:calc(6px * var(--ui-scale));
  z-index:40;
  font:900 calc(10px * var(--ui-scale))/1 ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  color:#fff;
  background:#111;
  border:1px solid rgba(255,255,255,.18);
  border-radius:calc(6px * var(--ui-scale));
  padding:calc(3px * var(--ui-scale)) calc(6px * var(--ui-scale));
  letter-spacing:.3px;
  box-shadow:0 calc(2px * var(--ui-scale)) calc(4px * var(--ui-scale)) rgba(0,0,0,.25);
  pointer-events:none;
}

.dice-overlay{
  position:absolute;inset:0;display:grid;place-items:center;background:rgba(0,0,0,.15);
  z-index:60
}
.dice-overlay.hidden{display:none}

/* FIXED-SIZE DICE (original look) */
.dice{
  width:72px;
  height:72px;
  background:#fff;
  border-radius:14px;
  box-shadow:0 10px 20px rgba(0,0,0,.35), inset 0 0 0 3px #151515;
  position:relative;
}
.pip{
  position:absolute;
  width:10px;
  height:10px;
  border-radius:50%;
  background:#111;
}

/* Centered outcome modal inside the board */
.outcome{
  position:absolute;
  left:50%;
  top:50%;
  transform:translate(-50%,-50%);
  max-width:calc(var(--stage-size) * 0.86);
  width:calc(var(--stage-size) * 0.86);
  padding:calc(14px * var(--ui-scale)) calc(16px * var(--ui-scale));
  border-radius:calc(14px * var(--ui-scale));
  background:#0f1520;
  border:1px solid #2a3342;
  z-index:85;

  /* bigger type */
  font-size:calc(16px * var(--ui-scale));
  line-height:1.35;
  box-shadow:0 calc(18px * var(--ui-scale)) calc(60px * var(--ui-scale)) rgba(0,0,0,.55), inset 0 0 0 1px rgba(255,255,255,.04);
}
.outcome.hidden{display:none}
.outcome strong{display:block; font-size:calc(22px * var(--ui-scale)); margin-bottom:calc(6px * var(--ui-scale));}
.outcome .subtitle{opacity:.9; color:#c7d0db}

.outcome.success{border-color:#238636}
.outcome.error{border-color:#f85149}
.outcome.warning{border-color:#d29922}
.outcome.info{border-color:#6e7681}

/* outcome overlay backdrop that blocks clicks to the board and buttons */
#outcome-backdrop{
  position:absolute; inset:0;
  background:rgba(0,0,0,.28);
  z-index:80;
}
#outcome-backdrop.hidden{display:none}

/* Close button row (bottom-right inside the modal) */
.outcome .actions{
  display:flex;
  justify-content:flex-end;
  margin-top:calc(12px * var(--ui-scale));
}
.outcome .actions button{
  background:#1f6feb;
  border:1px solid #2f81f7;
  color:#fff;
  border-radius:calc(8px * var(--ui-scale));
  padding:calc(8px * var(--ui-scale)) calc(12px * var(--ui-scale));
  font-weight:700;
  cursor:pointer;
}

/* Legacy loading chip */
#loading{
  position:absolute; right:calc(12px * var(--ui-scale)); top:calc(12px * var(--ui-scale));
  display:flex; align-items:center; gap:calc(8px * var(--ui-scale));
  background:rgba(0,0,0,.45); color:#fff; padding:calc(6px * var(--ui-scale)) calc(10px * var(--ui-scale));
  border-radius:calc(10px * var(--ui-scale));
  border:1px solid rgba(255,255,255,.18); z-index:70;
}
#loading.hidden{display:none}
.spinner{
  width:calc(16px * var(--ui-scale)); height:calc(16px * var(--ui-scale)); border-radius:50%;
  border:3px solid rgba(255,255,255,.35);
  border-top-color:#fff; animation:spin 0.9s linear infinite;
}
@keyframes spin{to{transform:rotate(360deg)}}

/* Dialog */
dialog{
  border:none;border-radius:16px;padding:0;background:#0b1117;color:#e6edf3;
  max-width:min(720px, 92vw); width:92vw;
}
#pending-form{padding:16px}
#pending-form h2{margin:0 0 8px}
#p-body{font-size:14px;color:#b6c2d0;margin-bottom:8px}
#p-answer{
  width:100%;min-height:140px;
  border-radius:10px;border:1px solid #232a35;background:#0e141b;color:#e6edf3;padding:8px
}
.actions{display:flex;gap:8px;justify-content:flex-end;margin-top:12px}
.actions .primary{background:#1f6feb;color:#fff;border:1px solid #2f81f7;border-radius:8px;padding:8px 12px}
