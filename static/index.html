<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Interviewopoly</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/static/style.css" />
</head>
<body>
  <header id="page-header">
    <h1>Interviewopoly</h1>
    <div class="hud">
      <!-- Cash removed from HUD -->
      <div class="metric"><span>Offer Points</span><strong id="m-offers">0</strong></div>
      <div class="metric"><span>Turns Left</span><strong id="m-turns">0</strong></div>
      <div class="metric"><span>Owned</span><strong id="m-owned">0</strong></div>
    </div>
    <div class="controls">
      <button id="btn-new" type="button">New Game</button>
      <button id="btn-roll" type="button">Roll ðŸŽ²</button>
    </div>
  </header>

  <main id="page-main">
    <div id="board-wrap">
      <div class="stage">
        <div id="board" class="board">
          <div class="center-logo">
            <img id="center-logo-img" src="/static/assets/logo_transparent.png" alt="" />
            <svg id="center-fallback" viewBox="0 0 1200 360" width="100%" height="100%" aria-hidden="true" style="position:absolute;inset:0;display:none">
              <defs>
                <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
                  <feDropShadow dx="0" dy="3" stdDeviation="5" flood-color="#000" flood-opacity="0.35"/>
                </filter>
              </defs>
              <rect x="10" y="10" rx="26" ry="26" width="1180" height="340" fill="#ED1B24" filter="url(#shadow)"/>
              <g>
                <text x="50%" y="58%" text-anchor="middle"
                      font-family="Impact, Haettenschweiler, 'Arial Narrow Bold', Arial, sans-serif"
                      font-size="160" fill="#fff" letter-spacing="4"
                      style="paint-order: stroke; stroke: rgba(0,0,0,0.12); stroke-width: 8;">
                  INTERVIEWOPOLY
                </text>
              </g>
            </svg>
          </div>

          <div class="dice-overlay hidden" id="dice-overlay">
            <div style="display:flex; gap:22px;">
              <div class="dice" id="die1">
                <div class="pip"></div><div class="pip"></div><div class="pip"></div>
                <div class="pip"></div><div class="pip"></div><div class="pip"></div>
              </div>
              <div class="dice" id="die2">
                <div class="pip"></div><div class="pip"></div><div class="pip"></div>
                <div class="pip"></div><div class="pip"></div><div class="pip"></div>
              </div>
            </div>
          </div>

          <div id="loading" class="hidden">
            <div class="spinner"></div>
            <div>Preparing questionâ€¦</div>
          </div>

          <div id="pawn" class="pawn"></div>
        </div>
      </div>

      <div id="outcome" class="outcome hidden"></div>
    </div>
  </main>

  <dialog id="pending-modal">
    <form method="dialog" id="pending-form">
      <h2 id="p-title">Pending</h2>
      <div id="p-body"></div>
      <textarea id="p-answer" placeholder="Write your answer here..."></textarea>
      <div class="actions">
        <button value="cancel">Cancel</button>
        <button type="submit" class="primary" id="p-submit">Submit</button>
      </div>
    </form>
  </dialog>

  <script>
    // center logo fallback
    (function(){
      const img = document.getElementById('center-logo-img');
      const fb  = document.getElementById('center-fallback');
      img.addEventListener('error', () => { img.style.display='none'; fb.style.display='block'; });
      img.addEventListener('load', () => { fb.style.display='none'; });
    })();

    // responsive sizing + debug log
    (function(){
      const root = document.documentElement;
      const header = document.getElementById('page-header');
      const main = document.getElementById('page-main');

      function innerPad(el){
        const cs = getComputedStyle(el);
        return {
          x: parseFloat(cs.paddingLeft) + parseFloat(cs.paddingRight),
          y: parseFloat(cs.paddingTop) + parseFloat(cs.paddingBottom)
        };
      }

      function resizeBoard(){
        const vw = Math.max(document.documentElement.clientWidth, window.innerWidth || 0);
        const vh = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);

        const headerH = header.offsetHeight;
        const pad = innerPad(main);

        const availW = Math.max(320, vw - pad.x) - 2;
        const availH = Math.max(320, vh - headerH - pad.y) - 2;

        const size = Math.floor(Math.min(availW, availH));
        const scale = size / 960;

        root.style.setProperty('--stage-size', size + 'px');
        root.style.setProperty('--ui-scale', String(scale));

        document.documentElement.style.overflow = 'hidden';
        document.body.style.overflow = 'hidden';

        console.log('[resizeBoard]',
          { vw, vh, headerH, padX: pad.x, padY: pad.y, availW, availH, size, scale });
      }

      window.addEventListener('resize', resizeBoard, { passive:true });
      window.addEventListener('orientationchange', resizeBoard, { passive:true });
      window.addEventListener('load', resizeBoard, { passive:true });
      resizeBoard();
    })();
  </script>
  <script src="/static/app.js"></script>
</body>
</html>
